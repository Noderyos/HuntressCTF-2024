# Strange Calc

## Solver : `Noderyos`

`file calc.exe` gives `calc.exe: PE32 executable (GUI) Intel 80386, for MS Windows, UPX compressed, 3 sections`

So we need to unpack it with `upx -d calc.exe`

Running `strings calc.exe` gives more information as we find "AutoIt v3" in assembly description

Using [AutoIt-Reaper](https://github.com/nazywam/AutoIt-Ripper) we can extract its source code with `autoit-ripper --verbose calc.exe .`

I removed the last few lines that execute commands, I run it with AutoIt, generating a JSE file with random name. 

I then used [scrdec](https://github.com/sstraw/scrdec/blob/master/scrdec.py) to decode the file and get a Beautiful JScript file (the script is crashing, but we get the most important part) `python3 scrdec.py -i cW87RvfC5O.jse -o cW87RvfC5O.js`.

After cleaning up the code, I removed the last few lines that run commands, added `WScript.Echo(c)` just before the function return.

Then executed the file with `cscript cW87RvfC5O-deobf.js` than gave me the flag.

## Flag : `flag{9922fb21aaf1757e3fdb28d7890a5d93}`
